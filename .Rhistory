dyAxis("y", "Power (kW)") %>%
dySeries("building", "Building", "navy") %>%
dySeries("battery", "Battery", "purple") %>%
dySeries("production", "Production", "orange") %>%
dyLegend(width = 200, show = "onmouseover") %>%
dyOptions(strokeWidth = 2)
opt_battery <- opt_data %>%
mutate(
static = building
) %>%
# select(datetime, production, static = building) %>%
add_battery_optimization(
opt_objective = "grid",
Bcap = 50, Bc = 10, Bd = 4,
window_start_hour = 0,
lambda = 0
)
opt_data %>%
select(datetime, production, building) %>%
mutate(battery = opt_battery) %>%
dyplot() %>%
dyAxis("y", "Power (kW)") %>%
dySeries("building", "Building", "navy") %>%
dySeries("battery", "Battery", "purple") %>%
dySeries("production", "Production", "orange") %>%
dyLegend(width = 200, show = "onmouseover") %>%
dyOptions(strokeWidth = 2)
opt_battery <- opt_data %>%
mutate(
static = building
) %>%
# select(datetime, production, static = building) %>%
add_battery_optimization(
opt_objective = "grid",
Bcap = 50, Bc = 10, Bd = 4,
lambda = 0
)
opt_data %>%
select(datetime, production, building) %>%
mutate(battery = opt_battery) %>%
dyplot() %>%
dyAxis("y", "Power (kW)") %>%
dySeries("building", "Building", "navy") %>%
dySeries("battery", "Battery", "purple") %>%
dySeries("production", "Production", "orange") %>%
dyLegend(width = 200, show = "onmouseover") %>%
dyOptions(strokeWidth = 2)
devtools::load_all(".")
opt_battery <- opt_data %>%
mutate(
static = building
) %>%
# select(datetime, production, static = building) %>%
add_battery_optimization(
opt_objective = "grid",
Bcap = 50, Bc = 10, Bd = 4,
window_start_hour = 0,
lambda = 0
)
opt_data %>%
select(datetime, production, building) %>%
mutate(battery = opt_battery) %>%
dyplot() %>%
dyAxis("y", "Power (kW)") %>%
dySeries("building", "Building", "navy") %>%
dySeries("battery", "Battery", "purple") %>%
dySeries("production", "Production", "orange") %>%
dyLegend(width = 200, show = "onmouseover") %>%
dyOptions(strokeWidth = 2)
opt_building <- opt_data %>%
mutate(
flexible = building
) %>%
optimize_demand(
opt_objective = "cost",
direction = "backward"
)
opt_building <- opt_data %>%
mutate(
flexible = building
) %>%
optimize_demand(
opt_objective = "cost",
direction = "foward"
)
opt_building <- opt_data %>%
mutate(
flexible = building
) %>%
optimize_demand(
opt_objective = "cost",
direction = "forward"
)
opt_building <- opt_data %>%
mutate(
flexible = building
) %>%
optimize_demand(
opt_objective = "cost",
direction = "backward"
)
opt_building <- opt_data %>%
select(datetime, production, flexible = building, price_imported, price_exported) %>%
optimize_demand(
opt_objective = "cost",
direction = "backward"
)
devtools::load_all(".")
opt_building <- opt_data %>%
select(datetime, production, flexible = building, price_imported, price_exported) %>%
optimize_demand(
opt_objective = "cost",
direction = "backward"
)
opt_data %>%
select(datetime, production, building) %>%
mutate(opt_building = opt_building) %>%
dyplot() %>%
dyAxis("y", "Power (kW)") %>%
dySeries("building", "Original building", "gray") %>%
dySeries("opt_building", "Optimal building", "navy") %>%
dySeries("production", "Production", "orange") %>%
dyLegend(width = 200, show = "onmouseover") %>%
dyOptions(strokeWidth = 2)
opt_data %>%
select(datetime, production, building) %>%
mutate(opt_building = opt_building) %>%
dyplot() %>%
dyAxis("y", "Power (kW)") %>%
dySeries("building", "Original building", "gray") %>%
dySeries("opt_building", "Optimal building", "navy") %>%
dySeries("production", "Production", "orange") %>%
dySeries("price_imported", "Imported APX price", axis = "y2", color = "red", strokePattern = "dashed", strokeWidth = 2) %>%
dySeries("price_exported","Exported fixed price",  axis = "y2", color = "green", strokePattern = "dashed", strokeWidth = 2) %>%
dyLegend(width = 200, show = "onmouseover") %>%
dyOptions(strokeWidth = 2)
opt_data %>%
select(datetime, production, building) %>%
mutate(opt_building = opt_building) %>%
dyplot() %>%
dyAxis("y", "Power (kW)") %>%
dyAxis("y2", "Price (€/kWh)") %>%
dySeries("building", "Original building", "gray") %>%
dySeries("opt_building", "Optimal building", "navy") %>%
dySeries("production", "Production", "orange") %>%
dySeries("price_imported", "Imported APX price", axis = "y2", color = "red", strokePattern = "dashed", strokeWidth = 2) %>%
dySeries("price_exported","Exported fixed price",  axis = "y2", color = "green", strokePattern = "dashed", strokeWidth = 2) %>%
dyLegend(width = 200, show = "onmouseover") %>%
dyOptions(strokeWidth = 2)
opt_data %>%
select(datetime, production, flexible = building, price_imported, price_exported) %>%
mutate(opt_building = opt_building) %>%
dyplot() %>%
dyAxis("y", "Power (kW)") %>%
dyAxis("y2", "Price (€/kWh)") %>%
dySeries("building", "Original building", "gray") %>%
dySeries("opt_building", "Optimal building", "navy") %>%
dySeries("production", "Production", "orange") %>%
dySeries("price_imported", "Imported APX price", axis = "y2", color = "red", strokePattern = "dashed", strokeWidth = 2) %>%
dySeries("price_exported","Exported fixed price",  axis = "y2", color = "green", strokePattern = "dashed", strokeWidth = 2) %>%
dyLegend(width = 200, show = "onmouseover") %>%
dyOptions(strokeWidth = 2)
opt_building <- opt_data %>%
select(datetime, production, building, price_imported, price_exported) %>%
mutate(
flexible = building
) %>%
optimize_demand(
opt_objective = "cost",
direction = "backward"
)
opt_data %>%
select(datetime, production, flexible = building, price_imported, price_exported) %>%
mutate(opt_building = opt_building) %>%
dyplot() %>%
dyAxis("y", "Power (kW)") %>%
dyAxis("y2", "Price (€/kWh)") %>%
dySeries("building", "Original building", "gray") %>%
dySeries("opt_building", "Optimal building", "navy") %>%
dySeries("production", "Production", "orange") %>%
dySeries("price_imported", "Imported APX price", axis = "y2", color = "red", strokePattern = "dashed", strokeWidth = 2) %>%
dySeries("price_exported","Exported fixed price",  axis = "y2", color = "green", strokePattern = "dashed", strokeWidth = 2) %>%
dyLegend(width = 200, show = "onmouseover") %>%
dyOptions(strokeWidth = 2)
opt_data %>%
select(datetime, production, building, price_imported, price_exported) %>%
mutate(opt_building = opt_building) %>%
dyplot() %>%
dyAxis("y", "Power (kW)") %>%
dyAxis("y2", "Price (€/kWh)") %>%
dySeries("building", "Original building", "gray") %>%
dySeries("opt_building", "Optimal building", "navy") %>%
dySeries("production", "Production", "orange") %>%
dySeries("price_imported", "Imported APX price", axis = "y2", color = "red", strokePattern = "dashed", strokeWidth = 2) %>%
dySeries("price_exported","Exported fixed price",  axis = "y2", color = "green", strokePattern = "dashed", strokeWidth = 2) %>%
dyLegend(width = 200, show = "onmouseover") %>%
dyOptions(strokeWidth = 2)
opt_building <- opt_data %>%
select(datetime, production, building, price_imported, price_exported) %>%
mutate(
flexible = building,
load_capacity = 5
) %>%
optimize_demand(
opt_objective = "cost",
direction = "backward"
)
opt_building <- opt_data %>%
select(datetime, production, building, price_imported, price_exported) %>%
mutate(
flexible = building,
load_capacity = 5
) %>%
optimize_demand(
opt_objective = "cost",
direction = "backward",
lambda = 0.5
)
opt_data %>%
select(datetime, production, building, price_imported, price_exported) %>%
mutate(opt_building = opt_building) %>%
dyplot() %>%
dyAxis("y", "Power (kW)") %>%
dyAxis("y2", "Price (€/kWh)") %>%
dySeries("building", "Original building", "gray") %>%
dySeries("opt_building", "Optimal building", "navy") %>%
dySeries("production", "Production", "orange") %>%
dySeries("price_imported", "Imported APX price", axis = "y2", color = "red", strokePattern = "dashed", strokeWidth = 2) %>%
dySeries("price_exported","Exported fixed price",  axis = "y2", color = "green", strokePattern = "dashed", strokeWidth = 2) %>%
dyLegend(width = 200, show = "onmouseover") %>%
dyOptions(strokeWidth = 2)
opt_building <- opt_data %>%
select(datetime, production, building, price_imported, price_exported) %>%
mutate(
flexible = building,
load_capacity = 5
) %>%
optimize_demand(
opt_objective = "cost",
direction = "backward",
lambda = 0
)
opt_data %>%
select(datetime, production, building, price_imported, price_exported) %>%
mutate(opt_building = opt_building) %>%
dyplot() %>%
dyAxis("y", "Power (kW)") %>%
dyAxis("y2", "Price (€/kWh)") %>%
dySeries("building", "Original building", "gray") %>%
dySeries("opt_building", "Optimal building", "navy") %>%
dySeries("production", "Production", "orange") %>%
dySeries("price_imported", "Imported APX price", axis = "y2", color = "red", strokePattern = "dashed", strokeWidth = 2) %>%
dySeries("price_exported","Exported fixed price",  axis = "y2", color = "green", strokePattern = "dashed", strokeWidth = 2) %>%
dyLegend(width = 200, show = "onmouseover") %>%
dyOptions(strokeWidth = 2)
devtools::load_all(".")
opt_building <- opt_data %>%
select(datetime, production, building, price_imported, price_exported) %>%
mutate(
flexible = building,
load_capacity = 5
) %>%
optimize_demand(
opt_objective = "cost",
direction = "backward",
lambda = 0
)
opt_data %>%
select(datetime, production, building, price_imported, price_exported) %>%
mutate(
flexible = building,
load_capacity = 5
) %>%
optimize_demand(
opt_objective = "cost",
direction = "backward",
lambda = 0
)
devtools::load_all(".")
opt_data %>%
select(datetime, production, building, price_imported, price_exported) %>%
mutate(
flexible = building,
load_capacity = 5
) %>%
optimize_demand(
opt_objective = "cost",
direction = "backward",
lambda = 0
)
devtools::load_all(".")
flextools:::minimize_net_power_window
opt_data %>%
select(datetime, production, building, price_imported, price_exported) %>%
mutate(
flexible = building,
load_capacity = 5
) %>%
optimize_demand(
opt_objective = "cost",
direction = "backward",
lambda = 0
)
devtools::load_all(".")
opt_data %>%
select(datetime, production, building, price_imported, price_exported) %>%
mutate(
flexible = building,
load_capacity = 5
) %>%
optimize_demand(
opt_objective = "cost",
direction = "backward",
lambda = 0
)
# library(flextools)
library(dplyr)
library(lubridate)
library(dygraphs)
library(dutils)
plot_cost_opt_battery <- function(opt_data_batt) {
energy_cost <- opt_data_batt %>%
mutate(
consumption = static + battery
) %>%
get_energy_cost()
imbalance_income <- opt_data_batt %>%
mutate(
demand_baseline = 0,
demand_final = battery
) %>%
get_imbalance_income()
opt_data_batt %>%
dyplot(
title = paste0("Energy cost: ", round(energy_cost), "€, Imbalance income: ", round(imbalance_income), "€")
) %>%
dyAxis("y", "Power (kW)") %>%
dyAxis("y2", "Price (€/kWh)") %>%
dySeries("static", "Building", "navy") %>%
dySeries("production", "Production", "orange") %>%
dySeries("price_imported", "Imported APX price", axis = "y2", color = "red", strokePattern = "dashed", strokeWidth = 2) %>%
dySeries("price_exported","Exported fixed price",  axis = "y2", color = "green", strokePattern = "dashed", strokeWidth = 2) %>%
dySeries("price_turn_up","Turn-up price",  axis = "y2", color = "#003300", strokePattern = "dashed", strokeWidth = 2) %>%
dySeries("price_turn_down","Turn-down price",  axis = "y2", color = "#669900", strokePattern = "dashed", strokeWidth = 2) %>%
dySeries("battery", "Battery", "purple") %>%
dyLegend(width = 200, show = "onmouseover") %>%
dyOptions(strokeWidth = 2)
}
devtools::load_all(".")
opt_data %>%
select(datetime, production, building, price_imported, price_exported) %>%
mutate(
flexible = building,
load_capacity = 5
) %>%
optimize_demand(
opt_objective = "cost",
direction = "backward",
lambda = 0
)
opt_data <- energy_profiles %>%
filter(isoweek(datetime) == 18) %>%
rename(
production = solar
)
opt_data %>%
select(datetime, production, building, price_imported, price_exported) %>%
mutate(
flexible = building,
load_capacity = 5
) %>%
optimize_demand(
opt_objective = "cost",
direction = "backward",
lambda = 0
)
devtools::load_all(".")
opt_data %>%
select(datetime, production, building, price_imported, price_exported) %>%
mutate(
flexible = building,
load_capacity = 5
) %>%
optimize_demand(
opt_objective = "cost",
direction = "backward",
lambda = 0
)
devtools::load_all(".")
opt_data %>%
select(datetime, production, building, price_imported, price_exported) %>%
mutate(
flexible = building,
load_capacity = 5
) %>%
optimize_demand(
opt_objective = "cost",
direction = "backward",
lambda = 0
)
# library(flextools)
library(dplyr)
library(lubridate)
library(dygraphs)
library(dutils)
plot_cost_opt_battery <- function(opt_data_batt) {
energy_cost <- opt_data_batt %>%
mutate(
consumption = static + battery
) %>%
get_energy_cost()
imbalance_income <- opt_data_batt %>%
mutate(
demand_baseline = 0,
demand_final = battery
) %>%
get_imbalance_income()
opt_data_batt %>%
dyplot(
title = paste0("Energy cost: ", round(energy_cost), "€, Imbalance income: ", round(imbalance_income), "€")
) %>%
dyAxis("y", "Power (kW)") %>%
dyAxis("y2", "Price (€/kWh)") %>%
dySeries("static", "Building", "navy") %>%
dySeries("production", "Production", "orange") %>%
dySeries("price_imported", "Imported APX price", axis = "y2", color = "red", strokePattern = "dashed", strokeWidth = 2) %>%
dySeries("price_exported","Exported fixed price",  axis = "y2", color = "green", strokePattern = "dashed", strokeWidth = 2) %>%
dySeries("price_turn_up","Turn-up price",  axis = "y2", color = "#003300", strokePattern = "dashed", strokeWidth = 2) %>%
dySeries("price_turn_down","Turn-down price",  axis = "y2", color = "#669900", strokePattern = "dashed", strokeWidth = 2) %>%
dySeries("battery", "Battery", "purple") %>%
dyLegend(width = 200, show = "onmouseover") %>%
dyOptions(strokeWidth = 2)
}
opt_data <- energy_profiles %>%
filter(isoweek(datetime) == 18) %>%
rename(
production = solar
)
opt_building <- opt_data %>%
select(datetime, production, building, price_imported, price_exported) %>%
mutate(
flexible = building,
load_capacity = 5
) %>%
optimize_demand(
opt_objective = "cost",
direction = "backward",
lambda = 0
)
opt_building <- opt_data %>%
select(datetime, production, building, price_imported, price_exported) %>%
mutate(
flexible = building,
load_capacity = 5
) %>%
optimize_demand(
opt_objective = "cost",
direction = "backward",
lambda = 0
)
devtools::load_all(".")
opt_building <- opt_data %>%
select(datetime, production, building, price_imported, price_exported) %>%
mutate(
flexible = building,
load_capacity = 5
) %>%
optimize_demand(
opt_objective = "cost",
direction = "backward",
lambda = 0
)
opt_data <- energy_profiles %>%
filter(isoweek(datetime) == 18) %>%
rename(
production = solar
)
opt_building <- opt_data %>%
select(datetime, production, building, price_imported, price_exported) %>%
mutate(
flexible = building,
load_capacity = 5
) %>%
optimize_demand(
opt_objective = "cost",
direction = "backward",
lambda = 0
)
opt_data %>%
select(datetime, production, building, price_imported, price_exported) %>%
mutate(
flexible = building,
load_capacity = 5
) %>%
optimize_demand(
opt_objective = "cost",
direction = "backward",
lambda = 0
)
opt_data %>%
select(datetime, production, building, price_imported, price_exported) %>%
mutate(opt_building = opt_building) %>%
dyplot() %>%
dyAxis("y", "Power (kW)") %>%
dyAxis("y2", "Price (€/kWh)") %>%
dySeries("building", "Original building", "gray") %>%
dySeries("opt_building", "Optimal building", "navy") %>%
dySeries("production", "Production", "orange") %>%
dySeries("price_imported", "Imported APX price", axis = "y2", color = "red", strokePattern = "dashed", strokeWidth = 2) %>%
dySeries("price_exported","Exported fixed price",  axis = "y2", color = "green", strokePattern = "dashed", strokeWidth = 2) %>%
dyLegend(width = 200, show = "onmouseover") %>%
dyOptions(strokeWidth = 2)
